"use strict";(self.webpackChunkidetools_dev=self.webpackChunkidetools_dev||[]).push([[5894],{6042:e=>{e.exports=JSON.parse('{"blogPosts":[{"id":"lsp4ij-dap-announcement","metadata":{"permalink":"/blog/lsp4ij-dap-announcement","source":"@site/blog/2025-03-10-lsp4ij-dap-annoucement.md","title":"Meet LSP4IJ, a new Debug Adapter Protocol for JetBrains-based IDEs","description":"LSP4IJ is a free and open-source Language Server Protocol (LSP) client for JetBrains-based IDEs, compatible with both community and enterprise flavors.","date":"2025-03-10T00:00:00.000Z","tags":[{"label":"lsp","permalink":"/blog/tags/lsp"},{"label":"intellij","permalink":"/blog/tags/intellij"},{"label":"lsp4ij","permalink":"/blog/tags/lsp-4-ij"},{"label":"dap","permalink":"/blog/tags/dap"}],"readingTime":8.19,"hasTruncateMarker":false,"authors":[{"name":"Angelo Zerr","title":"Principal Software Engineer @ Red Hat","url":"https://github.com/angelozerr","imageURL":"https://github.com/angelozerr.png","key":"angelozerr"}],"frontMatter":{"slug":"lsp4ij-dap-announcement","title":"Meet LSP4IJ, a new Debug Adapter Protocol for JetBrains-based IDEs","authors":["angelozerr"],"tags":["lsp","intellij","lsp4ij","dap"]},"unlisted":false,"nextItem":{"title":"Supporting dynamic code actions in VS Code Java","permalink":"/blog/dynamic-proposals"}},"content":"[LSP4IJ](https://plugins.jetbrains.com/plugin/23257-lsp4ij) is a free and open-source Language Server Protocol (LSP) client for JetBrains-based IDEs, compatible with both **community** and enterprise flavors.\\r\\n\\r\\nSince the article [Meet LSP4IJ, a new LSP Client for JetBrains-based IDEs](https://idetools.dev/blog/lsp4ij-announcement/) was written, LSP support has improved considerably:\\r\\n\\r\\n * implementation of new LSP features, such as support for LSP \\r\\n[On Type Formatting](https://github.com/redhat-developer/lsp4ij/blob/main/docs/LSPSupport.md#on-type-formatting)\\r\\n[Semantic Tokens](https://github.com/redhat-developer/lsp4ij/blob/main/docs/LSPSupport.md#semantic-tokens),\\r\\n[Call Hierarchy](https://github.com/redhat-developer/lsp4ij/blob/main/docs/LSPSupport.md#call-hierarchy), \\r\\n[Type Hierarchy](https://github.com/redhat-developer/lsp4ij/blob/main/docs/LSPSupport.md#type-hierarchy),\\r\\n[Document Symbol](https://github.com/redhat-developer/lsp4ij/blob/main/docs/LSPSupport.md#document-symbol)\\r\\n[Workspace Symbol](https://github.com/redhat-developer/lsp4ij/blob/main/docs/LSPSupport.md#workspace-symbol), etc.\\r\\n * [LSP API client features](https://github.com/redhat-developer/lsp4ij/blob/main/docs/LSPApi.md) that allows plugin adapters to customize the LSP features.\\r\\n\\r\\nThe latest version of LSP4IJ includes all of these improvements to LSP support, but what sets it apart from other releases \\r\\nis that it provides a new, free and open-source [Debug Adapter Protocol](https://microsoft.github.io/debug-adapter-protocol/) (DAP) client for JetBrains-based IDEs, compatible with both **community** and enterprise flavors.\\r\\n\\r\\n# LSP support improvement\\r\\n\\r\\nHere is a list of some LSP improvements. To know in detail all the improvements, it is recommended to read the \\r\\n[LSP support](https://github.com/redhat-developer/lsp4ij/blob/main/docs/LSPSupport.md) section.\\r\\n\\r\\n## LSP features\\r\\n\\r\\nLSP hover now supports syntax coloration for markdown code blocks :\\r\\n\\r\\n![LSP Hover / markdown](./assets/lsp4ij-dap-announcement/lsp/textDocument_hover_syntax_coloration.png)\\r\\n\\r\\nLSP on type formatting is now supported:\\r\\n\\r\\n![On Type Formatting](./assets/lsp4ij-dap-announcement/lsp/textDocument_onTypeFormatting.gif)\\r\\n\\r\\nLSP selection range is now supported:\\r\\n\\r\\n![LSP selection range](./assets/lsp4ij-dap-announcement/lsp/textDocument_selectionRange.gif)\\r\\n\\r\\nLSP workspace symbol is now supported:\\r\\n\\r\\n![LSP workspace symbol](./assets/lsp4ij-dap-announcement/lsp/workspace_symbol.gif)\\r\\n\\r\\nLSP call hierarchy is now supported:\\r\\n\\r\\n![LSP Call Hierarchy](./assets/lsp4ij-dap-announcement/lsp/textDocument_callHierarchy.png)\\r\\n\\r\\n## User defined Language Server\\r\\n\\r\\nServer configuration is done with a JSON editor that can be associated with a JSON schema\\r\\nto provide validation, completion, and hovering when editing the server configuration:\\r\\n\\r\\n![Set Breakpoint](./assets/lsp4ij-dap-announcement/lsp/server_configuration.png)\\r\\n\\r\\n# Debug Adapter Protocol (DAP)\\r\\n\\r\\n[LSP4IJ\'s DAP support](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/UserGuide.md) \\r\\n\\r\\n * allows to connect to the DAP server via `stdio` and `socket` \\r\\n * and handle both types of request `launch` and `attach`.\\r\\n\\r\\nHere is a list of DAP servers that have been tested to implement this DAP support:\\r\\n\\r\\n| DAP Server                                                                                                                      | stdio | socket | launch | attach |\\r\\n|---------------------------------------------------------------------------------------------------------------------------------|-------|--------|--------|--------|\\r\\n| [Go Delve DAP server](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/user-defined-dap/go-delve.md)               |       | X      | X      |        |\\r\\n| [Julia DAP server](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/user-defined-dap/julia.md)                     |       | X      | X      |        |\\r\\n| [Python Debugpy DAP server](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/user-defined-dap/python-debugpy.md)   |       | X      |        | X      |\\r\\n| [Swift DAP Server](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/user-defined-dap/swift-lldb.md)                | X     |        | X      |        |\\r\\n| [VSCode JS Debug DAP Server](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/user-defined-dap/vscode-js-debug.md) |       | X      | X      |        |\\r\\n\\r\\n## VSCode JS Debug\\r\\n\\r\\nTakes a sample with vscode js debug\\r\\n\\r\\nTo debug JavaScript or TypeScript files, you can use the [VSCode JS Debug](https://github.com/microsoft/vscode-js-debug) DAP server.\\r\\n\\r\\nLet\u2019s debugging the following `test.js` file:\\r\\n\\r\\n```js\\r\\nconst s = \\"foo\\";\\r\\nconsole.log(s);\\r\\n```\\r\\n\\r\\n![Set Breakpoint](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/set_breakpoint.png)\\r\\n\\r\\n### Configure DAP server\\r\\n\\r\\n1. Download the `js-debug-dap-v*.tar.gz` asset from the [VSCode JS Debug releases](https://github.com/microsoft/vscode-js-debug/releases).  \\r\\n   For example, download [js-debug-dap-v1.96.0.tar.gz](https://github.com/microsoft/vscode-js-debug/releases/download/v1.96.0/js-debug-dap-v1.96.0.tar.gz), which is the latest version at the time of writing.\\r\\n\\r\\n2. Extract the archive into any folder (e.g., `/home/path/to/dap`). The extracted folder should contain the DAP server at `/js-debug/src/dapDebugServer.js`.\\r\\n\\r\\n3. Create a DAP Run/Debug configuration:\\r\\n\\r\\n   ![DAP Configuration Type](./assets/lsp4ij-dap-announcement/dap/DAP_config_type.png)\\r\\n\\r\\n4. In the `Server` tab, click on `create a new server`:\\r\\n\\r\\n   ![Create a new server](./assets/lsp4ij-dap-announcement/dap/DAP_server_create_link.png)\\r\\n\\r\\n5. It opens a new dialog to create DAP server, select `VSCode JS Debug` template:\\r\\n   ![Select Template](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/select_template.png)\\r\\n\\r\\n6. After clicking on `OK` button, it will select the new server and pre-fill configurations:\\r\\n\\r\\n![Select New server](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/select_new_server.png)\\r\\n\\r\\nThis will automatically populate:\\r\\n\\r\\n* the server `name`\\r\\n* the `command` which starts the DAP server which should look like this:\\r\\n\\r\\n```\\r\\nnode <<insert base directory>>/js-debug/src/dapDebugServer.js ${port} 127.0.0.1\\r\\n```\\r\\n\\r\\nReplace `<<insert base directory>>` with the directory  (e.g., `/home/path/to/dap`) where you extracted the DAP server. For example:\\r\\n\\r\\n```\\r\\nnode /home/path/to/dap/js-debug/src/dapDebugServer.js ${port} 127.0.0.1\\r\\n```\\r\\n\\r\\nThe `${port}` argument will be replaced with a free port when the run configuration starts.\\r\\n\\r\\n* the `Connect to the server by waiting` option is set to `Log pattern before processing` with:\\r\\n\\r\\n ```\\r\\n Debug server listening at\\r\\n```\\r\\n\\r\\nThis means the DAP (Debug Adapter Protocol) client will connect to the DAP server when this trace appears in the console:\\r\\n\\r\\n```\\r\\nnode /home/path/to/dap/js-debug-dap-v1.96.0/js-debug/src/dapDebugServer.js 56425 127.0.0.1\\r\\nDebug server listening at 127.0.0.1:56425\\r\\n```\\r\\n\\r\\n5. Enable DAP server traces\\r\\n\\r\\nIf you wish to show DAP request/response traces when you will debug:\\r\\n\\r\\n![Show DAP traces](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/traces_in_console.png)\\r\\n\\r\\nyou need to select `Trace` with `verbose`.\\r\\n\\r\\n![Set verbose traces](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/set_traces.png)\\r\\n\\r\\n### Configure file mappings\\r\\n\\r\\nTo allows settings breakpoints to JavaScript, TypeScript, etc files, you need configure mappings in the `Mappings` tab.\\r\\nAs you have selected `VSCode JS Debug` server, it will automatically populate the file mappings like this:\\r\\n\\r\\n![File mappings](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/file_mappings_tab.png)\\r\\n\\r\\n### Configure the JavaScript file to run/debug\\r\\n\\r\\n1. Fill in the `Configuration` tab:\\r\\n\\r\\n- the `working directory` (usually the project\'s root directory)\\r\\n- the path to the `test.js` file.\\r\\n\\r\\n![DAP Configuration Type/Configuration](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/configuration_tab.png)\\r\\n\\r\\n2. Select `Launch` as `Debug mode`.\\r\\n3. The DAP parameters of the launch should look like this:\\r\\n\\r\\n```json\\r\\n{\\r\\n   \\"type\\": \\"pwa-node\\",\\r\\n   \\"name\\": \\"Launch JavaScript file\\",\\r\\n   \\"request\\": \\"launch\\",\\r\\n   \\"program\\": \\"${file}\\",\\r\\n   \\"cwd\\": \\"${workspaceFolder}\\"\\r\\n}\\r\\n```\\r\\n\\r\\nWhen the run configuration starts:\\r\\n\\r\\n- `${workspaceFolder}` will be replaced with the working directory you specified.\\r\\n- `${file}` will be replaced with the full path to `test.js`.\\r\\n\\r\\n#### Set Breakpoint\\r\\n\\r\\nAfter applying the run configuration, you should set a breakpoint to files which matches file mappings.\\r\\nSet a breakpoint in the `test.js` file:\\r\\n\\r\\n![Set Breakpoint](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/set_breakpoint.png)\\r\\n\\r\\n#### Debugging\\r\\n\\r\\nYou can start the run configuration in either Run or Debug mode. Once started, you should see DAP traces in the console:\\r\\n\\r\\n![Debugging / Console](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/debug_console_tab.png)\\r\\n\\r\\nYou will also see `Threads` and `Variables`:\\r\\n\\r\\n![Debugging / Threads](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/debug_threads_tab.png)\\r\\n\\r\\n### Configure the TypeScript file to run/debug\\r\\n\\r\\nLet\u2019s debugging the following `test.ts` file:\\r\\n\\r\\n```ts\\r\\nclass Greeter {\\r\\n  greeting: string;\\r\\n\\r\\n  constructor(message: string) {\\r\\n    this.greeting = message;\\r\\n  }\\r\\n\\r\\n  greet() {\\r\\n    return \\"Hello, \\" + this.greeting;\\r\\n  }\\r\\n}\\r\\n\\r\\nlet greeter = new Greeter(\\"world\\");\\r\\nconsole.log(greeter.greet())\\r\\n```\\r\\n\\r\\n![Set Breakpoint](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/set_breakpoint_ts.png)\\r\\n\\r\\n#### Compile TypeScript\\r\\n\\r\\nCreate a `tsconfig.json` file like this:\\r\\n\\r\\n```json\\r\\n{\\r\\n   \\"compilerOptions\\": {\\r\\n      \\"target\\": \\"ES6\\",\\r\\n      \\"module\\": \\"CommonJS\\",\\r\\n      \\"outDir\\": \\"out\\",\\r\\n      \\"sourceMap\\": true\\r\\n   }\\r\\n}\\r\\n```\\r\\n\\r\\nExecute `tsc` command to generate source maps in the `out` folder:\\r\\n\\r\\n* `test.js`\\r\\n* `test.js.map`\\r\\n\\r\\n#### Configure the TypeScript file to run/debug\\r\\n\\r\\nSelect the `Launch TypeScript file` configuration:\\r\\n\\r\\n![Select TypeScript Launch](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/select_typescript_launch.png)\\r\\n\\r\\nwhich will update the DAP parameters like this:\\r\\n\\r\\n```json\\r\\n{\\r\\n   \\"type\\": \\"pwa-node\\",\\r\\n   \\"name\\": \\"Launch TypeScript file\\",\\r\\n   \\"request\\": \\"launch\\",\\r\\n   \\"program\\": \\"${file}\\",\\r\\n   \\"cwd\\": \\"${workspaceFolder}\\",\\r\\n   \\"outFiles\\": [\\r\\n      \\"${workspaceFolder}/**/*.(m|c|)js\\",\\r\\n      \\"!**/node_modules/**\\"\\r\\n   ],\\r\\n   \\"sourceMaps\\": true,\\r\\n   \\"__workspaceFolder\\": \\"${workspaceFolder}\\"\\r\\n}\\r\\n```\\r\\n\\r\\nUpdate the path with the `test.ts` file.\\r\\n\\r\\n![DAP Configuration Type/Configuration](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/configuration_ts_tab.png)\\r\\n\\r\\n#### Debugging\\r\\n\\r\\nTypeScript debugging should be available:\\r\\n\\r\\n![Debugging TypeScript](./assets/lsp4ij-dap-announcement/dap/vscode-js-debug/debug_ts.png)\\r\\n\\r\\n## How to integrate your Debug Adapter Server in an IntelliJ plugin.\\r\\n\\r\\n# Developer Guide\\r\\n\\r\\nDAP support provides a [generic DAP configuration interface](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/UserGuide.md) that allows to configure any DAP server.\\r\\nThe fact that it is generic can confuse the user with all the possible configurations.\\r\\n\\r\\nTo improve the user experience, it is possible to register a custom DAP server via the **experimental**\\r\\n[`com.redhat.devtools.lsp4ij.debugAdapterServer` extension point](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/DeveloperGuide.md#debugadapterserver-extension-point) which allows for example:\\r\\n\\r\\n* to [embed the DAP server in its plugin](#embed-the-dap-server) to avoid the user to download it, to configure its environment.\\r\\n* to [customize the DAP server startup](#customize-the-dap-server-startup) to avoid the user to configure it.\\r\\n\\r\\n# TypeScript DAP server\\r\\n\\r\\nIn this example we will explain how to register [VSCode JS Debug DAP server](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/user-defined-dap/vscode-js-debug.md)\\r\\nwith the `com.redhat.devtools.lsp4ij.debugAdapterServer` extension point.\\r\\n\\r\\n## Embed the DAP server\\r\\n\\r\\nHere we will embed the [VSCode JS Debug DAP server](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/user-defined-dap/vscode-js-debug.md) in the plugin `my.plugin.id`.\\r\\nYou will need to download the `js-debug-dap-v*.tar.gz` asset from the [VSCode JS Debug releases](https://github.com/microsoft/vscode-js-debug/releases), unzip it\\r\\nand copy/paste the `js-debug` folder in your `src/main/resources` folder:\\r\\n\\r\\n![Embed VSCode JS Debug](./assets/lsp4ij-dap-announcement/dap/extension-point/DAP_server_embed.png)\\r\\n\\r\\n## Customize the DAP server startup\\r\\n\\r\\nConfiguring manually [VSCode JS Debug DAP server](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/user-defined-dap/vscode-js-debug.md) can be boring:\\r\\n\\r\\n* you need to download `js-debug-dap-v*.tar.gz`, unzip it, and update the `<<insert base directory>>`\\r\\n  to use the proper path of the DAP server.\\r\\n* the UI configuration is little complex.\\r\\n\\r\\n![DAP generic interface server](./assets/lsp4ij-dap-announcement/dap/extension-point/DAP_generic_interface_server.png)\\r\\n\\r\\nIn this step we will register the DAP server with the `com.redhat.devtools.lsp4ij.debugAdapterServer` extension point.\\r\\n\\r\\n### DebugAdapterDescriptor\\r\\n\\r\\nCreate the `TypeScriptDebugAdapterDescriptor` class like this:\\r\\n\\r\\n```java\\r\\npackage my.dap.server;\\r\\n\\r\\nimport com.intellij.execution.ExecutionException;\\r\\nimport com.intellij.execution.configurations.GeneralCommandLine;\\r\\nimport com.intellij.execution.configurations.RunConfigurationOptions;\\r\\nimport com.intellij.execution.process.ProcessHandler;\\r\\nimport com.intellij.execution.runners.ExecutionEnvironment;\\r\\nimport com.intellij.openapi.fileTypes.FileType;\\r\\nimport com.redhat.devtools.lsp4ij.dap.client.LaunchUtils;\\r\\nimport com.redhat.devtools.lsp4ij.dap.configurations.options.FileOptionConfigurable;\\r\\nimport com.redhat.devtools.lsp4ij.dap.configurations.options.WorkingDirectoryConfigurable;\\r\\nimport com.redhat.devtools.lsp4ij.dap.definitions.DebugAdapterServerDefinition;\\r\\nimport com.redhat.devtools.lsp4ij.dap.descriptors.DebugAdapterDescriptor;\\r\\nimport com.redhat.devtools.lsp4ij.dap.descriptors.ServerReadyConfig;\\r\\nimport org.jetbrains.annotations.NotNull;\\r\\nimport org.jetbrains.annotations.Nullable;\\r\\n\\r\\nimport java.nio.file.Path;\\r\\nimport java.util.Map;\\r\\n\\r\\nimport static com.redhat.devtools.lsp4ij.dap.descriptors.DebugAdapterDescriptorFactory.getDebugAdapterServerPath;\\r\\n\\r\\npublic class TypeScriptDebugAdapterDescriptor extends DebugAdapterDescriptor {\\r\\n\\r\\n    private static final String PLUGIN_ID = \\"my.plugin.id\\";\\r\\n\\r\\n    private final static Path dapServerPath;\\r\\n\\r\\n    static {\\r\\n        dapServerPath = getDebugAdapterServerPath(PLUGIN_ID, \\"js-debug/src/dapDebugServer.js\\");\\r\\n    }\\r\\n\\r\\n    public TypeScriptDebugAdapterDescriptor(@NotNull RunConfigurationOptions options,\\r\\n                                            @NotNull ExecutionEnvironment environment,\\r\\n                                            @Nullable DebugAdapterServerDefinition serverDefinition) {\\r\\n        super(options, environment, serverDefinition);\\r\\n    }\\r\\n\\r\\n    @Override\\r\\n    public ProcessHandler startServer() throws ExecutionException {\\r\\n        String command = \\"node \\" + dapServerPath.toString() + \\" ${port} 127.0.0.1\\";\\r\\n        GeneralCommandLine commandLine = createStartServerCommandLine(command);\\r\\n        return startServer(commandLine);\\r\\n    }\\r\\n\\r\\n    @Override\\r\\n    public @NotNull Map<String, Object> getDapParameters() {\\r\\n        // language=JSON\\r\\n        String launchJson = \\"\\"\\"                \\r\\n                {\\r\\n                  \\"type\\": \\"pwa-node\\",\\r\\n                  \\"name\\": \\"Launch TypeScript file\\",\\r\\n                  \\"request\\": \\"launch\\",\\r\\n                  \\"program\\": \\"${file}\\",\\r\\n                  \\"cwd\\": \\"${workspaceFolder}\\",\\r\\n                  \\"outFiles\\": [\\r\\n                    \\"${workspaceFolder}/**/*.(m|c|)js\\",\\r\\n                    \\"!**/node_modules/**\\"\\r\\n                  ],\\r\\n                  \\"sourceMaps\\": true,\\r\\n                  \\"__workspaceFolder\\": \\"${workspaceFolder}\\"\\r\\n                }\\r\\n                \\"\\"\\";\\r\\n        String file = ((FileOptionConfigurable) options).getFile();\\r\\n        String workspaceFolder = ((WorkingDirectoryConfigurable) options).getWorkingDirectory();\\r\\n        LaunchUtils.LaunchContext context = new LaunchUtils.LaunchContext(file, workspaceFolder);\\r\\n        return LaunchUtils.getDapParameters(launchJson, context);\\r\\n    }\\r\\n\\r\\n    @Override\\r\\n    public @NotNull ServerReadyConfig getServerReadyConfig(@NotNull DebugMode debugMode) {\\r\\n        return new ServerReadyConfig(\\"Debug server listening at \\");\\r\\n    }\\r\\n\\r\\n    @Override\\r\\n    public @Nullable FileType getFileType() {\\r\\n        return null;\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\n### DebugAdapterDescriptorFactory\\r\\n\\r\\nCreate the `TypeScriptDebugAdapterDescriptorFactory` class like this:\\r\\n\\r\\n```java\\r\\npackage my.dap.server;\\r\\n\\r\\nimport com.intellij.execution.runners.ExecutionEnvironment;\\r\\nimport com.redhat.devtools.lsp4ij.dap.configurations.DAPRunConfigurationOptions;\\r\\nimport com.redhat.devtools.lsp4ij.dap.descriptors.DebugAdapterDescriptor;\\r\\nimport com.redhat.devtools.lsp4ij.dap.descriptors.DebugAdapterDescriptorFactory;\\r\\nimport org.jetbrains.annotations.NotNull;\\r\\n\\r\\npublic class TypeScriptDebugAdapterDescriptorFactory extends DebugAdapterDescriptorFactory {\\r\\n\\r\\n    @Override\\r\\n    public DebugAdapterDescriptor createDebugAdapterDescriptor(@NotNull DAPRunConfigurationOptions options, \\r\\n                                                               @NotNull ExecutionEnvironment environment) {\\r\\n        return new TypeScriptDebugAdapterDescriptor(options, environment, getServerDefinition());\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\n### debugAdapterServer extension point\\r\\n\\r\\nRegister the `TypeScriptDebugAdapterDescriptorFactory` class with the `debugAdapterServer` extension point like this:\\r\\n\\r\\n```xml\\r\\n<extensions defaultExtensionNs=\\"com.redhat.devtools.lsp4ij\\">\\r\\n    <debugAdapterServer\\r\\n        id=\\"typescript\\"\\r\\n        name=\\"TypeScript\\"\\r\\n        factoryClass=\\"my.dap.server.TypeScriptDebugAdapterDescriptorFactory\\" />\\r\\n</extensions>\\r\\n```\\r\\n\\r\\n### Test your debugAdapterServer\\r\\n\\r\\nAt this step, you can test your `TypeScriptDebugAdapterDescriptorFactory` with the generic Debug Adapter Protocol runconfiguration.\\r\\nYou should see TypeScript in the existing server,\\r\\n\\r\\n![DAP generic interface server](./assets/lsp4ij-dap-announcement/dap/extension-point/DAP_test_step1.png)\\r\\n\\r\\nSelect it, select the TypeScript file that you wish to run in the Configuration tab and run the configuration.\\r\\nIt should start your DAP server and execute the TypeScript file.\\r\\n\\r\\n# Conclusion\\r\\n\\r\\nThis article gives an overview of the new [DAP support](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/UserGuide.md) of LSP4IJ.\\r\\n\\r\\nIt allows to configure any DAP server with \\r\\n[DAP configuration type](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/UserGuide.md#dap-configuration-type). \\r\\n\\r\\nThe [DAP template system](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/UserGuide.md#templates) \\r\\nallows to pre-fill the configuration fields for a given DAP server.\\r\\n\\r\\nFeel free to contribute to LSP4IJ to add other templates like [vscode-js-debug template](https://github.com/redhat-developer/lsp4ij/tree/main/src/main/resources/dap/templates/vscode-js-debug)\\r\\n\\r\\nIt also allows to integrate a DAP server via the **experimental**\\r\\n[`com.redhat.devtools.lsp4ij.debugAdapterServer` extension point](https://github.com/redhat-developer/lsp4ij/blob/main/docs/dap/DeveloperGuide.md#debugadapterserver-extension-point)"},{"id":"dynamic-proposals","metadata":{"permalink":"/blog/dynamic-proposals","source":"@site/blog/2024-09-06-dynamic-proposals.md","title":"Supporting dynamic code actions in VS Code Java","description":"I\'m definitely not the first developer to say that quick fix suggestions make my life ten times easier. With dynamic proposals for code actions, my life gets even easier.","date":"2024-09-06T00:00:00.000Z","tags":[{"label":"vscode","permalink":"/blog/tags/vscode"},{"label":"java","permalink":"/blog/tags/java"},{"label":"snippet","permalink":"/blog/tags/snippet"},{"label":"code actions","permalink":"/blog/tags/code-actions"}],"readingTime":1.9,"hasTruncateMarker":false,"authors":[{"name":"Hope Hadfield","title":"Intern @ Red Hat","url":"https://github.com/hopehadfield","imageURL":"https://github.com/hopehadfield.png","key":"hopehadfield"}],"frontMatter":{"slug":"dynamic-proposals","title":"Supporting dynamic code actions in VS Code Java","authors":["hopehadfield"],"tags":["vscode","java","snippet","code actions"]},"unlisted":false,"prevItem":{"title":"Meet LSP4IJ, a new Debug Adapter Protocol for JetBrains-based IDEs","permalink":"/blog/lsp4ij-dap-announcement"},"nextItem":{"title":"Dropping support of older Java releases in vscode-java","permalink":"/blog/java-1_8-compliance"}},"content":"I\'m definitely not the first developer to say that quick fix suggestions make my life ten times easier. With dynamic proposals for code actions, my life gets even easier.\\n\\nMany quick fixes have multiple suggestions for text replacement. In the Eclipse IDE, these are displayed in a dropdown selection menu. Take a look at the type mismatch quick fix below, for example:\\n\\n![Example of linked proposal in Eclipse](./assets/dynamic-proposals/linked-proposal-eclipse.gif)\\n\\nVery helpful, right? Now let\'s take a look at how VS Code handles the same quick fix:\\n\\n![Example of old proposal in VS Code](./assets/dynamic-proposals/old-vscode-proposal.gif)\\n\\nNo dropdown, no options, just the first item from Eclipse\'s list inserted statically. Definitely less helpful.\\n\\nWhy is this? Well, code actions in Eclipse support dropdown choices, as well as placeholders, which enable dynamic text insertion/replacement. Code actions in VS Code, on the other hand, do not. The closest we can get to simulating this behaviour in VS Code is by using snippets, which similarly have choices/placeholders. Unfortunately, we couldn\'t support snippet strings in code actions without violating the [Language Server Protocol](https://microsoft.github.io/language-server-protocol/) specification... until now!\\n\\nWith the introduction and support of SnippetTextEdit in [LSP](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.18/specification/#snippetTextEdit) and [VS Code](https://code.visualstudio.com/api/references/vscode-api#SnippetTextEdit), dynamic code actions will now be supported in the upcoming release of vscode-java 1.35.0! If you can\'t wait, they\'re also available now in pre-release.\\n\\nCheck out the relevant [PR](https://github.com/redhat-developer/vscode-java/pull/3730) in [vscode-java](https://github.com/redhat-developer/vscode-java) and its supporting [PR](https://github.com/eclipse-jdtls/eclipse.jdt.ls/pull/3229) in [JDT-LS](https://github.com/eclipse-jdtls/eclipse.jdt.ls).\\n\\n## The Point\\n\\nCode actions, which were once completely static, now prompt you to alter relevant sections of text and give you multiple suggestions for insertion and replacement.\\n\\n![Example of dynamic proposal in VS Code](./assets/dynamic-proposals/dynamic-proposal-vscode.gif)\\n\\nPretty cool.\\n\\n## Limitations\\n\\nThis improvement doesn\'t come without a few minor setbacks. \\n\\nFor code actions that propose new types, the import for the selected type cannot be automatically resolved. Instead, after applying the code action and selecting the new type from the dropdown, the user has to either manually import the type, apply the subsequent quick fix suggestion to import the type, or issue the \'Organize Imports\' command (`Shift` + `Alt` + `O`). \\n\\nAdditionally, any code action that involves multi-line text insertion will see additional indentation on all lines excluding the first one. You can see this happen in the above example. This is due to a [bug](https://github.com/microsoft/vscode/issues/63129) in VS Code that automatically adds indentation to snippet strings."},{"id":"java-1_8-compliance","metadata":{"permalink":"/blog/java-1_8-compliance","source":"@site/blog/2024-08-29-java-1_8-compliance.md","title":"Dropping support of older Java releases in vscode-java","description":"A percentage (~4%) of users trying out our latest release of vscode-java 1.33.0 were probably disappointed to note that we dropped support for Java versions prior to 1.8. This wasn\'t something we did intentionally but it happened in the JDT Core library that we rely on for much of our Java functionality. While losing existing functionality is frustrating, I\'ll go over why this change was necessary and how it will set up the JDT Core project, the Java language server (JDT-LS), and vscode-java for success in the longer term.","date":"2024-08-29T00:00:00.000Z","tags":[{"label":"vscode","permalink":"/blog/tags/vscode"},{"label":"java","permalink":"/blog/tags/java"},{"label":"lsp","permalink":"/blog/tags/lsp"}],"readingTime":1.495,"hasTruncateMarker":false,"authors":[{"name":"Roland Grunberg","title":"Principal Software Developer @ Red Hat","url":"https://github.com/rgrunber","imageURL":"https://github.com/rgrunber.png","key":"rgrunber"}],"frontMatter":{"slug":"java-1_8-compliance","title":"Dropping support of older Java releases in vscode-java","authors":["rgrunber"],"tags":["vscode","java","lsp"]},"unlisted":false,"prevItem":{"title":"Supporting dynamic code actions in VS Code Java","permalink":"/blog/dynamic-proposals"},"nextItem":{"title":"Meet LSP4IJ, a new LSP Client for JetBrains-based IDEs","permalink":"/blog/lsp4ij-announcement"}},"content":"A percentage (~4%) of users trying out our latest release of vscode-java [1.33.0](https://github.com/redhat-developer/vscode-java/releases/tag/v1.33.0) were probably disappointed to note that we dropped support for Java versions prior to 1.8. This wasn\'t something we did intentionally but it happened in the [JDT Core](https://github.com/eclipse-jdt/eclipse.jdt.core) library that we rely on for much of our Java functionality. While losing existing functionality is frustrating, I\'ll go over why this change was necessary and how it will set up the JDT Core project, the Java language server ([JDT-LS](https://github.com/eclipse-jdtls/eclipse.jdt.ls)), and [vscode-java](https://github.com/redhat-developer/vscode-java) for success in the longer term.\\n\\n\\n### There\'s a JEP for that\\n\\n[JEP-182](https://openjdk.org/jeps/182) already defines a process for this exact thing. Although the policy would have to change to take into account the 6-month release cadence, it\'s clear that a move towards supporting fewer older releases is desired.\\n\\nAs of now, `javac` from the OpenJDK 22 developments tools no longer support a pre-1.8 source/target/release flag :\\n\\n```\\n$ javac --help\\n  ...\\n  ...\\n  --release <release>\\n        Compile for the specified Java SE release.\\n        Supported releases:\\n            8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22\\n  ...\\n  ...\\n```\\n\\n### Maintenance burden\\n\\nGoing through the discussion ( https://github.com/eclipse-jdt/eclipse.jdt.core/discussions/820 ) in JDT Core to drop the support, it\'s clear there\'s a cost to supporting the older versions. It also affects the time it takes to implement new features that must deal with the added complexity from those older versions. Simplifying the codebase will translate into more features, implemented more quickly and an easier maintenance.\\n\\n\\n### Perspective\\n\\nSo where does that leave affected users ? They could continue to stay on vscode-java [1.32.0](https://github.com/redhat-developer/vscode-java/releases/tag/v1.32.0), until they update their project to Java 1.8 or above. It\'s definitely not ideal for those depending on older Java versions but the newer features, and improvements should certainly make up for it."},{"id":"lsp4ij-announcement","metadata":{"permalink":"/blog/lsp4ij-announcement","source":"@site/blog/2024-06-20-lsp4ij-announcement.md","title":"Meet LSP4IJ, a new LSP Client for JetBrains-based IDEs","description":"LSP4IJ is a new, free and open-source Language Server Protocol (LSP) client for JetBrains-based IDEs, compatible with both community and enterprise flavors.","date":"2024-06-20T00:00:00.000Z","tags":[{"label":"lsp","permalink":"/blog/tags/lsp"},{"label":"intellij","permalink":"/blog/tags/intellij"},{"label":"lsp4ij","permalink":"/blog/tags/lsp-4-ij"}],"readingTime":9.55,"hasTruncateMarker":false,"authors":[{"name":"Angelo Zerr","title":"Principal Software Engineer @ Red Hat","url":"https://github.com/angelozerr","imageURL":"https://github.com/angelozerr.png","key":"angelozerr"},{"name":"Fred Bricon","title":"Principal Software Engineer @ Red Hat","url":"https://github.com/fbricon","imageURL":"https://github.com/fbricon.png","key":"fbricon"}],"frontMatter":{"slug":"lsp4ij-announcement","title":"Meet LSP4IJ, a new LSP Client for JetBrains-based IDEs","authors":["angelozerr","fbricon"],"tags":["lsp","intellij","lsp4ij"]},"unlisted":false,"prevItem":{"title":"Dropping support of older Java releases in vscode-java","permalink":"/blog/java-1_8-compliance"},"nextItem":{"title":"Create a Test Kubernetes Cluster With an Unprivileged User","permalink":"/blog/k8s-create-unprivileged-user"}},"content":"[LSP4IJ](https://plugins.jetbrains.com/plugin/23257-lsp4ij) is a new, free and open-source Language Server Protocol (LSP) client for JetBrains-based IDEs, compatible with both **community** and enterprise flavors.\\n\\nIt provides outstanding features such as:\\n- The ability to [configure LSP servers without developing a new plug-in](https://github.com/redhat-developer/lsp4ij/blob/main/docs/UserDefinedLanguageServer.md) (restricted to stdio-based connections for the moment).\\n- A [set of API allowing third-party adopters to contribute LSP extensions](https://github.com/redhat-developer/lsp4ij/blob/main/docs/DeveloperGuide.md) to the JetBrains ecosystem\\n- a [console view](https://github.com/redhat-developer/lsp4ij/blob/main/docs/UserGuide.md#lsp-console), allowing users to monitor and troubleshoot the communication between the IDE and the LSP servers.\\n\\nThe client already supports a significant amount of [features](https://github.com/redhat-developer/lsp4ij/blob/main/docs/LSPSupport.md) from the LSP 3.17 specification, and more are on their way.\\n\\n## Why LSP4IJ?\\n\\nThe Devtools team at Red Hat has been working on free and open-source language servers for *many* years. We have offered LSP implementations for [Java](https://github.com/eclipse/eclipse.jdt.ls/), [YAML](https://github.com/redhat-developer/yaml-language-server), [XML](https://github.com/eclipse/lemminx), [MicroProfile](https://github.com/eclipse/lsp4mp), [Quarkus](https://github.com/redhat-developer/quarkus-ls) and [Qute](https://github.com/redhat-developer/quarkus-ls/tree/master/qute.ls), that were integrated into Visual Studio Code via several extensions. Some of those language servers have also been integrated into Eclipse IDE.\\n\\nBy 2019, JetBrains already provided some [Quarkus](https://quarkus.io/) support in IntelliJ IDEA Ultimate to their paid customers. But when Red Hat wanted to bring the same awesome [Quarkus tools](https://marketplace.visualstudio.com/items?itemName=redhat.vscode-quarkus) VS Code already had, to the wider IntelliJ IDEA Community, an LSP client for IntelliJ was needed.\\n\\nAt that time, we evaluated [Ballerina\'s lsp4intellij library](https://github.com/ballerina-platform/lsp4intellij), which provides advanced LSP support but has the following limitations:\\n * Quarkus / Qute language servers have a complicated mechanism, delegating parts of the work to the IDE\'s Java support (JDT for Eclipse and Psi for IntelliJ), to avoid parsing Java classes twice (once by the language server, another the built-in Java support). We encountered numerous freezes.\\n * Ballerina implements certain LSP features without reusing IntelliJ built-in extension points (ex: hover, go to declaration)\\n * Tracing server status (starting, started, stopping, stopped) is difficult, which makes server startup issues hard to troubleshoot.\\n * Ballerina features are mostly based on a Timeout system, which stops LSP requests after a defined time.\\n\\nTo integrate our Quarkus and Qute language servers, the LSP support in IntelliJ needed to:\\n\\n * never freeze, even when the language server cannot be started.\\n * not rely on a timeout system, but instead properly manage LSP request cancellations (when the file is modified for example)\\n * provide a UI allowing easy tracking of the state of the language servers\\n * provide an LSP console that displays LSP traces and server logs.\\n\\nFor these reasons, we developed the LSP support we needed directly within the [`Quarkus Tools for IntelliJ`](https://github.com/redhat-developer/intellij-quarkus/) plugin. It actually started as a port of the [`Eclipse LSP4E`](https://github.com/eclipse/lsp4e) project. It took us several years, but we ended up with an LSP support that was mature and efficient.\\n\\nIn 2023, JetBrains finally decided to [start providing some LSP support](https://blog.jetbrains.com/platform/2023/07/lsp-for-plugin-developers/), but to only make it available in their commercial products, which was a not a good fit for us as we couldn\'t use it for `Quarkus Tools`. It was also lacking some features we really, really, liked in our LSP client, notably the LSP Consoles view.\\n\\nSeeing our own LSP support held up pretty well for Quarkus and Qute, we decided to extract it into its own standalone project, to provide generic LSP support, for all JetBrains products, notably the community ones. Hence LSP4IJ was born.\\n\\n## LSP support overview\\n\\n### LSP features\\n\\nLSP4IJ implements basic LSP features like `completion`, `validation`, `hover`, `go to definition`, but also more advanced ones, such as `codelens`, `inlay hints`, `quickfixes`, `rename`, `signature help` and others. \\n\\nHere\'s a quick example showcasing the [`gopls`](https://pkg.go.dev/golang.org/x/tools/gopls) language server in action:\\n\\n![Go Demo](./assets/lsp4ij-announcement/GoplsDemo.gif)\\n\\nThe [LSP Support](https://github.com/redhat-developer/lsp4ij/blob/main/docs/LSPSupport.md) page provides a complete overview of what LSP4IJ supports and details how it leverages specific IntelliJ extension points. While most features work out-of-the-box, a few [cases](https://github.com/redhat-developer/lsp4ij/blob/main/docs/DeveloperGuide.md#special-cases) require special configuration.\\n\\n#### Cancellation Support\\n\\nIn order to avoid using timeouts (that might still freeze the IDE), LSP4IJ implements [Cancellation Support](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#cancelRequest) to stop LSP requests when the file changes or when the IDE indicates the some requests (e.g. completion) are no longer relevant.\\n\\n### LSP consoles view\\n\\nAlthough not often useful to users, the [LSP consoles view](https://github.com/redhat-developer/lsp4ij/blob/main/docs/UserGuide.md#lsp-console) is extremely valuable when one needs to troubleshoot issues with the language servers. All servers can be configured to log traces, as simple or verbose messages. This console view is similar to Visual Studio Code\'s Output view, only more convenient, as message contents are collapsible:\\n\\n![LSP console](assets/lsp4ij-announcement/LSPConsole.png)\\n\\n## Installation\\n\\nLSP4IJ requires at least Java 17 and IntelliJ-based IDEs 2023.2 at the moment.\\n\\nThe LSP4IJ plugin is available in the stable channel of the [JetBrains Plugin Repository](https://plugins.jetbrains.com/plugin/23257-lsp4ij).\\n\\n## Quickly get started with LSP4IJ\\n\\nIf you want to *quickly test your language server with LSP4IJ without having to develop a plugin* or *if you\'re unfamiliar with IntelliJ plugin development*, LSP4IJ offers the possibility of integrating any language server (**only stdio mode is supported at the moment**) with [simple settings](https://github.com/redhat-developer/lsp4ij/blob/main/docs/UserDefinedLanguageServer.md) where you only need to define:\\n\\n * the language server `launch command`\\n * the `mapping` between the `language server` and the `files` targeted by the language server\\n\\n### Example: Adding TypeScript support\\n\\nFree/community IntelliJ-based IDEs only provide basic support for `TypeScript` in the form of syntax highlighting. In this section, we\'ll explain step-by-step how to integrate the [TypeScript language server](https://github.com/typescript-language-server/typescript-language-server) into your IntelliJ IDE, without having to develop anything, and immediately benefit from `TypeScript`, `React` and `JavaScript` support (completion, validation, quickfixes, codelens, etc):\\n\\n![TypeScriptServerDemo](assets/lsp4ij-announcement/TypeScriptServerDemo.gif)\\n\\n#### Step 1: Install the language server\\n\\nThis step describes how to install the language server. In our case, `typescript-language-server` is `Node.js` application and thus requires the `Node.js` runtime to run.\\n\\nYou will need to:\\n \\n* [Install `Node.js`](https://nodejs.org/en/download)\\n* [Install `typescript-language-server`](https://github.com/typescript-language-server/typescript-language-server?tab=readme-ov-file#installing). The simplest way is to open a terminal and execute the following command:\\n\\n> npm install -g typescript-language-server typescript\\n\\nIt will install:\\n\\n* [TypeScript language server](https://github.com/typescript-language-server/typescript-language-server): this project delegates the LSP operations (completion, diagnostics, etc) to the `tsserver` from [TypeScript](https://github.com/microsoft/TypeScript) which doesn\'t support LSP itself.\\n* [TypeScript](https://github.com/microsoft/TypeScript) which includes `tsserver`.\\n* As the command will add `typescript-language-server` to your OS PATH, you will probably have to close and reopen your IDE for the command to be accessible by LSP4IJ. \\n\\n#### Step 2: Create a language server in LSP4IJ\\n\\nIn order to create a new [User-defined language server](https://github.com/redhat-developer/lsp4ij/blob/main/docs/UserDefinedLanguageServer.md), you need to open the `New Language Server` dialog, either:\\n\\n * from the menu on the right of the LSP console:\\n\\n![New Language Server From Console](./assets/lsp4ij-announcement/NewLanguageServerFromConsole.png)\\n\\n* or with the `[+]` on the top of the language server settings:\\n\\n![New Language Server From Settings](./assets/lsp4ij-announcement/NewLanguageServerFromSettings.png)\\n\\nOnce you clicked on either of them, the dialog will appear:\\n\\n![New Language Server Dialog](./assets/lsp4ij-announcement/NewLanguageServerDialogEmpty.png)\\n\\nTo quickly configure TypeScript support, you could use the [TypeScript template](https://github.com/redhat-developer/lsp4ij/blob/main/docs/user-defined-ls/typescript-language-server.md) which will pre-fill all fields (command and mappings), but in order to better understand the process, let\'s do that manually:\\n\\n##### Define launch command\\n\\nIn the `Server` tab, set:\\n\\n * `Name` as `TypeScript Language Server`.\\n * `Command` as `typescript-language-server --stdio`\\n\\n![New Language Server Dialog with TypeScript](./assets/lsp4ij-announcement/TypeScriptServerDialog.png)\\n\\nNote that you can use [macros in your commands](https://github.com/redhat-developer/lsp4ij/blob/main/docs/UserDefinedLanguageServer.md#macro-syntax), to make them more portable, should you choose to [export you server](#Export-server).\\n\\n##### Define mappings\\n\\nIn the `Mappings > File name patterns` tab, associate `*.ts`, `*.tsx`, `*.jsx` files to the language server as shown below :\\n\\n| File Name Pattern |    Language Id  |\\n|-------------------|-----------------|\\n| *.jsx             | javascriptreact |\\n| *.ts              | typescript      |\\n| *.tsx             | typescriptreact |\\n\\n![File name patterns](./assets/lsp4ij-announcement/TypeScriptServerDialog_FileNamePatterns.png)\\n\\n\\nThe value in the `Language Id` column must be one of the language identifiers defined in the [LSP specification](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#textDocumentItem).\\n\\n##### Define configuration\\n\\nBy default, `codelens` and `inlayhint` are not available in the TypeScript Language Server, you can enable them by filling the `Configuration` tab with the following JSON settings:\\n\\n```json\\n{\\n  \\"typescript\\": {\\n    \\"inlayHints\\": {\\n      \\"includeInlayEnumMemberValueHints\\": true,\\n      \\"includeInlayFunctionLikeReturnTypeHints\\": true,\\n      \\"includeInlayFunctionParameterTypeHints\\": true,\\n      \\"includeInlayParameterNameHints\\": \\"all\\",\\n      \\"includeInlayParameterNameHintsWhenArgumentMatchesName\\": true,\\n      \\"includeInlayPropertyDeclarationTypeHints\\": true,\\n      \\"includeInlayVariableTypeHints\\": true,\\n      \\"includeInlayVariableTypeHintsWhenTypeMatchesName\\": true\\n    },\\n    \\"implementationsCodeLens\\": {\\n      \\"enabled\\": true\\n    },\\n    \\"referencesCodeLens\\": {\\n      \\"enabled\\": true,\\n      \\"showOnAllFunctions\\": true\\n    }\\n  }\\n}\\n```\\n![TypeScript Language Server configuration page](./assets/lsp4ij-announcement/ts-ls-config.png)\\n\\nClick the `OK` button, and you should see the `TypeScript Language Server` in the `Language Servers` view:\\n\\n![TypeScript Language Server in the console view](./assets/lsp4ij-announcement/ts-ls-traces.png)\\n\\nCreate a `ts` file and open it. The `TypeScript Language Server` should start and you should now be able to use TypeScript support with completion, hover, linting...\\n\\n### Using a Template\\n\\nLSP4IJ provides [a few templates](https://github.com/redhat-developer/lsp4ij/blob/main/docs/UserDefinedLanguageServer.md#using-template) for various language servers. You can select the [TypeScript Language Server](https://github.com/redhat-developer/lsp4ij/blob/main/docs/user-defined-ls/typescript-language-server.md) template which will pre-fill all fields previously described (server name, command and mappings).\\n\\n\\n### Export server\\n\\nIf you want to share your language server settings, you can [export it](https://github.com/redhat-developer/lsp4ij/blob/main/docs/UserDefinedLanguageServer.md#exporting-templates) to generate a zip file, that, once shared and unzipped to a directory, can be [imported](https://github.com/redhat-developer/lsp4ij/blob/main/docs/UserDefinedLanguageServer.md#custom-template).\\n\\n## How to integrate your language server in an IntelliJ plugin.\\n\\nManually defining a language server via settings allows you to add a language server into IntelliJ in a few minutes, but if you need to provide better integration with the IDE, embedding the language server definition in an IntelliJ plugin will be a better solution:\\n\\n * it is possible to embed the language server and/or provide a mechanism to download/update the language server, etc. make it easier for users to get started.\\n * advanced language servers require implementing specific client-side commands, which is only possible through the development of an IntelliJ plugin.\\n \\nThe [Developer Guide](https://github.com/redhat-developer/lsp4ij/blob/main/docs/DeveloperGuide.md)  provides step-by-step instructions for contributing an LSP language server in your IntelliJ plugin.\\n\\nThe following example shows how to integrate the `TypeScript Language Server` in an IntelliJ plugin. In your plugin.xml, you would declare the server like this:\\n\\n```xml\\n<extensions defaultExtensionNs=\\"com.redhat.devtools.lsp4ij\\">\\n    <server id=\\"typeScriptLanguageServerId\\"\\n            name=\\"TypeScript Language Server\\"\\n            factoryClass=\\"com.yourplugin.lsp.TypeScriptLanguageServerFactory\\">\\n        <description><![CDATA[\\n        Some description written in HTML, that will be displayed in the LSP consoles view and Language Servers settings.\\n        ]]>\\n        </description>\\n    </server>\\n</extensions>\\n```\\n\\nand mappings like this by using [File name pattern mapping](https://github.com/redhat-developer/lsp4ij/blob/main/docs/DeveloperGuide.md#file-name-pattern-mapping):\\n\\n```xml\\n<extensions defaultExtensionNs=\\"com.redhat.devtools.lsp4ij\\">\\n\\n    <fileNamePatternMapping patterns=\\"*.ts\\"\\n                            serverId=\\"typeScriptLanguageServerId\\"\\n                            languageId=\\"typescript\\"/>\\n\\n</extensions>\\n```\\n\\nThe `com.yourplugin.lsp.TypeScriptLanguageServerFactory` factory class looks like this:\\n\\n```java\\npackage com.yourplugin.lsp;\\n\\nimport com.intellij.openapi.project.Project;\\nimport com.redhat.devtools.lsp4ij.LanguageServerFactory;\\nimport com.redhat.devtools.lsp4ij.client.LanguageClientImpl;\\nimport com.redhat.devtools.lsp4ij.server.StreamConnectionProvider;\\nimport org.jetbrains.annotations.NotNull;\\n\\npublic class TypeScriptLanguageServerFactory implements LanguageServerFactory {\\n\\n    @Override\\n    public @NotNull StreamConnectionProvider createConnectionProvider(@NotNull Project project) {\\n        return new TypeScriptLanguageServer(project);\\n    }\\n\\n}\\n```\\n\\n```java\\npackage com.yourplugin.lsp;\\n\\nimport com.redhat.devtools.lsp4ij.server.ProcessStreamConnectionProvider;\\n\\nimport java.util.List;\\n\\npublic class TypeScriptLanguageServer extends ProcessStreamConnectionProvider {\\n\\n    public MyLanguageServer() {\\n        List<String> commands = List.of(\\"typescript-language-server\\", \\"--stdio\\");\\n        super.setCommands(commands);\\n    }\\n}\\n```\\n\\nThis code assumes `typescript-language-server` is available on the PATH, but it could be improved to target an embedded TypeScript language server inside your IntelliJ plugin.\\n\\n## Conclusion\\n\\nThis article only scratches the surface of what `LSP4IJ` provides. You can find more documentation in:\\n\\n * [the user guide](https://github.com/redhat-developer/lsp4ij/tree/main/docs/UserGuide.md), describing how to use the LSP consoles view and Language Server preferences.\\n * [the LSP Support overview](https://github.com/redhat-developer/lsp4ij/tree/main/docs/LSPSupport.md), detailing which LSP features are implemented, and how.\\n * [the User-defined language server documentation](https://github.com/redhat-developer/lsp4ij/tree/main/docs/UserDefinedLanguageServer.md), explaining how to integrate a language server in LSP4IJ with minimal settings. \\n * [the developer guide](https://github.com/redhat-developer/lsp4ij/tree/main/docs/DeveloperGuide.md), providing step-by-step instructions on how to integrate a language server in LSP4IJ in an external IntelliJ plugin.\\n\\nCreating a new LSP client for JetBrains-based IDEs has been a very humbling and rewarding experience. With each new language server we tested, we found slightly different behaviors to account for, eventually making LSP4IJ more and more robust. \\nThe initial feedback from the community has been very encouraging so far. We hope you will find LSP4IJ useful!\\n\\nIf you find any bugs or can think of ideas for some great new features, please don\u2019t hesitate to head over to our Github repository and [open a ticket](https://github.com/redhat-developer/lsp4ij/issues). Since our test framework is built around [LSP requests](https://github.com/redhat-developer/lsp4ij/blob/main/src/test/java/com/redhat/devtools/lsp4ij/features/completion/GoCompletionTest.java), you just need to copy traces from the LSP Consoles view so we can reproduce issues you find with your language server and fix them."},{"id":"k8s-create-unprivileged-user","metadata":{"permalink":"/blog/k8s-create-unprivileged-user","source":"@site/blog/2024-05-17-k8s-create-unpriviledged-user.md","title":"Create a Test Kubernetes Cluster With an Unprivileged User","description":"Motivation","date":"2024-05-17T00:00:00.000Z","tags":[{"label":"kubernetes","permalink":"/blog/tags/kubernetes"}],"readingTime":4.21,"hasTruncateMarker":false,"authors":[{"name":"David Thompson","title":"Software Developer @ Red Hat","url":"https://github.com/datho7561","imageURL":"https://github.com/datho7561.png","key":"datho7561"}],"frontMatter":{"slug":"k8s-create-unprivileged-user","title":"Create a Test Kubernetes Cluster With an Unprivileged User","authors":["datho7561"],"tags":["kubernetes"]},"unlisted":false,"prevItem":{"title":"Meet LSP4IJ, a new LSP Client for JetBrains-based IDEs","permalink":"/blog/lsp4ij-announcement"}},"content":"## Motivation\\n\\nYou are working on a software tool that interacts with Kubernetes clusters.\\nYou would like to troubleshoot bugs arising due to insufficient permissions\\nby simulating an environment where the user has heavily restricted permissions on the cluster.\\n\\n## Prerequisites\\n\\n- This tutorial assumes you are using Linux or macOS. The same general steps should work on Windows, except the paths and commands might be slightly different.\\n- Install [kind](https://kind.sigs.k8s.io/docs/user/quick-start/), needed to create the cluster.\\n- *(Optional)* install [kubectx](https://github.com/ahmetb/kubectx#installation), helpful for switching Kubernetes contexts.\\n\\n:::note\\nIf you don\'t install `kubectx`,\\nyou can change Kubernetes contexts by opening `~/.kube/config`,\\nand modifying the value of `current-context` to the name of the context you want to work with.\\nHowever, I find that it\'s much faster to use `kubectx`.\\nThe tutorial is written assuming you have installed `kubectx`.\\n:::\\n\\n## Steps\\n\\n### Creating the Cluster\\n\\nFirst, create the `kind` cluster:\\n\\n```bash\\nkind create cluster\\n```\\n\\nThis should take around a minute.\\n\\n### Creating the Service Account\\n\\nOnce the cluster is up and running, create a service account:\\n\\n```bash\\nkubectl create serviceaccount my-service-account\\n```\\n\\nAnd create a token associated with the service account:\\n\\n```bash\\nkubectl create token my-service-account --duration 72h\\n```\\n\\nThis second command will output the token into the console.\\nMake sure to copy this token into your clipboard.\\n\\nOpen up your kube config (`~/.kube/config`), and create a new user entry in the `users` section:\\n\\n\\n```diff\\n users:\\n+- name: my-service-account\\n+  user:\\n+    token: # PASTE TOKEN HERE AND REMOVE NEWLINES\\n - name: kind-kind\\n   user:\\n```\\n\\n:::warning\\nMake sure to add the token into the user entry and remove any newlines that are placed in the middle of the token,\\notherwise you will be unable to use the service account\\n:::\\n\\nThen, go up to the `contexts` section, and add the following new context:\\n\\n```diff\\n contexts:\\n - context:\\n     cluster: kind-kind\\n     namespace: default\\n     user: kind-kind\\n   name: kind-kind\\n+- context:\\n+    cluster: kind-kind\\n+    namespace: default\\n+    user: my-service-account\\n+  name: my-service-account-ctx\\n current-context: kind-kind\\n kind: Config\\n```\\n\\n### Creating the Role and Role Binding\\n\\nNext, create the following file, `service-account-permissions.yaml`:\\n\\n```yaml\\n---\\napiVersion: rbac.authorization.k8s.io/v1\\nkind: ClusterRole\\nmetadata:\\n  name: can-list-pod\\nrules:\\n  - apiGroups: [\\"\\"]\\n    resources: [\\"pods\\"]\\n    verbs: [\\"get\\", \\"list\\", \\"watch\\"]\\n---\\napiVersion: rbac.authorization.k8s.io/v1\\nkind: ClusterRoleBinding\\nmetadata:\\n  name: can-list-pod-binding\\nsubjects:\\n- kind: User\\n  name: system:serviceaccount:default:my-service-account\\n  apiGroup: rbac.authorization.k8s.io\\nroleRef:\\n  kind: ClusterRole\\n  name: can-list-pod\\n  apiGroup: rbac.authorization.k8s.io\\n```\\n\\nThen, apply this YAML to the cluster using the following command:\\n\\n```yaml\\nkubectl create -f service-account-permissions.yaml\\n```\\n\\nThis creates a [`ClusterRole`](https://kubernetes.io/docs/reference/access-authn-authz/rbac/#role-and-clusterrole),\\nwhich is a set of actions that an account is allowed to perform across all namespaces in a cluster.\\nThe `ClusterRole` is called `\\"can-list-pod\\"`, and it allows the user to list pods in all namespaces.\\nThe YAML file also creates a [`ClusterRoleBinding`](https://kubernetes.io/docs/reference/access-authn-authz/rbac/#rolebinding-and-clusterrolebinding),\\nwhich specifies that `\\"my-service-account\\"`, the service account we just created,\\nshould have the `ClusterRole` `\\"can-list-pod\\"`.\\n\\nNext, we need to switch to the newly created service account.\\nTo do this, run `kubectx my-service-account-ctx` to switch to the context that we created by editing `~/.kube/config`.\\n\\n### Testing the account\\n\\nIn order to test that the account was created successfully,\\ntry listing the namespaces on the cluster:\\n\\n```bash\\nkubectl get namespace\\n```\\n\\nYou should get an \\"unauthorized\\" warning,\\nbecause the only thing the service account is allowed to do on the cluster is list pods.\\n\\nNext, let\'s verify that you can list pods.\\nWe should create a pod on the cluster so that there is something to list.\\nUse `kubectx kind-kind` to switch back to the `kind-kind` context,\\nso that you have permissions to create pods.\\n\\nThen, run:\\n\\n```bash\\nkubectl create deployment --image quay.io/davthomp/pet-alpine my-deployment\\n```\\n\\nThis creates a deployment, which will automatically create and manage a pod.\\n\\n:::info[About the container image]\\nThe container image that\'s being run is from my Quay repository.\\nIt runs a \\"Hello World\\" webapp written in Go,\\ni.e. it serves the text \\"hello\\" over HTTP on port 8080 at the endpoint `/hello`.\\nIt uses Alpine Linux as the base image.\\n:::\\n\\nThen, switch back to the `my-service-account-ctx` context using `kubectx my-service-account-ctx`,\\nand then try to list the pods:\\n\\n```bash\\nkubectl get pods\\n```\\n\\nYou should see one pod that\'s listed: the pod managed by the deployment we created.\\n\\n### Next Steps\\n\\nYou\'ve successfully set up a service account with heavily restricted access to the cluster.\\n\\nIf you want to give the service account more permissions, you can modify and reapply `service-account-permissions.yaml`.\\nYou will need to switch back to the `kind-kind` user in order to reapply the changes.\\nRefer to [the Kubernetes documentation on role-based access control](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)\\nfor more information on setting up the permissions for the account.\\n\\n### Cleaning Up\\n\\nOnce you are done with the cluster,\\nmake sure to delete it.\\nAlso, make sure to remove the new user and context that you created from your `~/.kube/config`,\\nsince they will no longer exist when you delete the cluster.\\n\\n:::info[Check out our developer tools]\\nIf you liked this blog post,\\nmake sure to check out [VS Code OpenShift Toolkit](https://marketplace.visualstudio.com/items?itemName=redhat.vscode-openshift-connector)\\nor [Intellij OpenShift Toolkit](https://plugins.jetbrains.com/plugin/12030-openshift-toolkit-by-red-hat),\\nwhich enable you to interact with your Kubernetes or OpenShift cluster right from your IDE.\\n:::"}]}')}}]);